<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#1e293b" />
    <meta name="robots" content="index,follow" />
    <meta name="googlebot" content="index,follow" />
    <meta
      name="description"
      content="Ù…Ù†ØµØ© StellarSpeak Ù„ØªØ¹Ù„Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© - Ø¯Ø±ÙˆØ³ ØªÙØ§Ø¹Ù„ÙŠØ© Ù…Ø¬Ø§Ù†ÙŠØ©ØŒ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù…Ø³ØªÙˆÙ‰ØŒ ÙˆØ£Ø¯ÙˆØ§Øª ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ø¥ØªÙ‚Ø§Ù† Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©"
    />
    <meta name="keywords" content="ØªØ¹Ù„Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©, Ø¯Ø±ÙˆØ³ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©, Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„ØºØ©, Ù…ÙØ±Ø¯Ø§Øª, Ù†Ø·Ù‚, Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <link rel="sitemap" type="application/xml" href="%PUBLIC_URL%/sitemap.xml" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="//www.google-analytics.com">
    <link rel="dns-prefetch" href="//pagead2.googlesyndication.com">
    
    <!-- Critical CSS Ø§Ù„Ù…ÙØ¯Ù…Ø¬Ø© Ù„Ù…Ù†Ø¹ FOUC -->
    <style>
      /* Critical CSS Ù„Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙˆØ±ÙŠ */
      * {
        box-sizing: border-box;
      }
      
      body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
          'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
          sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        background-color: #0f172a;
        color: #e2e8f0;
        direction: rtl;
        overflow-x: hidden;
      }

      #root {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        position: relative;
      }

      /* ØªÙ†Ø³ÙŠÙ‚ Ø£Ø³Ø§Ø³ÙŠ Ù„Ù„Ù†ØµÙˆØµ */
      h1, h2, h3, h4, h5, h6 {
        color: #e2e8f0;
        margin: 0;
      }

      /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ */
      button {
        cursor: pointer;
        border: none;
        border-radius: 8px;
        padding: 12px 24px;
        font-weight: 500;
        transition: all 0.2s ease;
      }

      /* Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù…Ø­Ø³Ù†Ø© */
      .app-loading #root > *:not(.stellar-bg):not(.initial-loading) {
        opacity: 0;
        pointer-events: none;
      }

      .app-loaded #root > * {
        opacity: 1;
        pointer-events: auto;
        animation: contentFadeIn 0.3s ease-out;
      }

      @keyframes contentFadeIn {
        from { 
          opacity: 0; 
          transform: translateY(10px);
        }
        to { 
          opacity: 1; 
          transform: translateY(0);
        }
      }

      /* Loading indicator Ù…Ø­Ø³Ù† */
      .initial-loading {
        position: fixed;
        inset: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #0f172a;
        z-index: 1000;
      }

      /* Ø®Ù„ÙÙŠØ© Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ù†Ø¬ÙˆÙ… */
      .stellar-bg {
        position: fixed;
        inset: 0;
        background: linear-gradient(45deg, #0f172a 0%, #1e293b 100%);
        z-index: -1;
      }

      /* Spinner animation */
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      .spinner {
        width: 60px;
        height: 60px;
        border: 3px solid #374151;
        border-top: 3px solid #3b82f6;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
    </style>
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6736064173610503"
     crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MZPWQGFT9H"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-MZPWQGFT9H');
    </script>
    
    <!-- Ù…Ù†Ø¹ FOUC Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ø­Ø³Ù†Ø© -->
    <script>
      (function() {
        let cssLoaded = false;
        let reactReady = false;
        
        function markAppReady() {
          if (cssLoaded && reactReady) {
            document.body.classList.remove('app-loading');
            document.body.classList.add('app-loaded');
            
            const loadingElement = document.querySelector('.initial-loading');
            if (loadingElement) {
              setTimeout(() => {
                loadingElement.style.display = 'none';
              }, 300);
            }
          }
        }

        // Ù…Ø±Ø§Ù‚Ø¨Ø© ØªØ­Ù…ÙŠÙ„ CSS
        function watchCSS() {
          const checkCSS = () => {
            const cssLink = document.querySelector('link[href*="/static/css/main"]');
            if (cssLink && cssLink.sheet) {
              try {
                const rules = cssLink.sheet.cssRules || cssLink.sheet.rules;
                if (rules && rules.length > 0) {
                  cssLoaded = true;
                  markAppReady();
                  return;
                }
              } catch (e) {
                // CSS Ù„Ù… ÙŠØ­Ù…Ù„ Ø¨Ø¹Ø¯
              }
            }
            setTimeout(checkCSS, 50);
          };
          checkCSS();
        }

        // Ù…Ø±Ø§Ù‚Ø¨Ø© React readiness
        function watchReact() {
          if (window.React || document.querySelector('#root').children.length > 1) {
            reactReady = true;
            markAppReady();
          } else {
            setTimeout(watchReact, 50);
          }
        }

        // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', () => {
            watchCSS();
            watchReact();
          });
        } else {
          watchCSS();
          watchReact();
        }

        // Fallback timeout
        setTimeout(() => {
          if (!cssLoaded || !reactReady) {
            cssLoaded = true;
            reactReady = true;
            markAppReady();
          }
        }, 3000);
      })();
    </script>
    
    <title>StellarSpeak - Ù…Ù†ØµØ© ØªØ¹Ù„Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© | Ø¯Ø±ÙˆØ³ Ù…Ø¬Ø§Ù†ÙŠØ©</title>
  </head>
  <body class="app-loading">
    <noscript>
      <div style="text-align:center; padding:50px; font-family: Arial; background-color: #0f172a; color: #e2e8f0; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center;">
        <h1>ğŸŒŸ StellarSpeak</h1>
        <h2>Ù…Ù†ØµØ© ØªØ¹Ù„Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</h2>
        <p>Ø¹Ø°Ø±Ø§Ù‹ØŒ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªÙØ¹ÙŠÙ„ JavaScript Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</p>
        <p>Please enable JavaScript to use this application</p>
      </div>
    </noscript>
    
    <!-- Ø®Ù„ÙÙŠØ© Ø£Ø³Ø§Ø³ÙŠØ© -->
    <div class="stellar-bg"></div>
    
    <div id="root">
      <div class="initial-loading">
        <div style="text-align: center;">
          <div class="spinner"></div>
          <p style="margin-top: 20px; color: #94a3b8; font-size: 14px;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
        </div>
      </div>
    </div>
    
    <div id="notification-portal"></div>

    <!-- Service Worker Registration Script -->
    <script>
      // Ù…Ø¹Ø§Ù„Ø¬ Ù„Ù„Ù€ Promise rejections ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
      window.addEventListener('unhandledrejection', function(event) {
        console.error('Unhandled promise rejection in main thread:', event.reason);
        
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø®Ø·Ø£ Ù…ØªØ¹Ù„Ù‚ Ø¨Ù€ Service Worker
        if (event.reason && event.reason.message && 
            event.reason.message.includes('ServiceWorker')) {
            
          console.log('Service Worker error detected, attempting recovery...');
          
          // Ø¥Ø¹Ø§Ø¯Ø© ØªØ³Ø¬ÙŠÙ„ Service Worker
          navigator.serviceWorker.getRegistrations().then(function(registrations) {
            Promise.all(registrations.map(reg => reg.unregister())).then(() => {
              setTimeout(() => {
                registerServiceWorker();
              }, 2000);
            });
          });
        }
        
        event.preventDefault();
      });

      // ØªØ³Ø¬ÙŠÙ„ Service Worker
      if ('serviceWorker' in navigator) {
        function registerServiceWorker() {
          navigator.serviceWorker.register('/service-worker.js', {
            scope: '/',
            updateViaCache: 'none' // Ù…Ù†Ø¹ caching Ù„Ù…Ù„Ù Service Worker
          })
          .then(function(registration) {
            console.log('Service Worker registered successfully:', registration);
            
            // Ù…Ø¹Ø§Ù„Ø¬Ø© lifecycle events
            if (registration.installing) {
              trackInstalling(registration.installing);
            }
            
            registration.addEventListener('updatefound', function() {
              const newWorker = registration.installing;
              if (newWorker) {
                trackInstalling(newWorker);
              }
            });
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø¨Ø´ÙƒÙ„ Ø¯ÙˆØ±ÙŠ (ÙƒÙ„ 30 Ø¯Ù‚ÙŠÙ‚Ø©)
            setInterval(() => {
              registration.update().catch(error => {
                console.log('Failed to check for updates:', error);
              });
            }, 30 * 60 * 1000);
            
          })
          .catch(function(error) {
            console.error('Service Worker registration failed:', error);
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
            setTimeout(() => {
              registerServiceWorker();
            }, 5000);
          });
        }
        
        function trackInstalling(worker) {
          worker.addEventListener('statechange', function() {
            if (worker.state === 'installed') {
              if (navigator.serviceWorker.controller) {
                // Service Worker Ø¬Ø¯ÙŠØ¯ Ù…ØªØ§Ø­
                showUpdateNotification();
              } else {
                // Service Worker ØªÙ… ØªØ«Ø¨ÙŠØªÙ‡ Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©
                console.log('Service Worker installed for the first time');
              }
            } else if (worker.state === 'redundant') {
              console.error('Service Worker became redundant');
            }
          });
        }
        
        function showUpdateNotification() {
          // ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ù†Ø§
          if (confirm('ÙŠØªÙˆÙØ± ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙŠØ¯ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©ØŸ')) {
            window.location.reload();
          }
        }
        
        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø±Ø³Ø§Ø¦Ù„ Service Worker
        navigator.serviceWorker.addEventListener('message', function(event) {
          const { type, message, error } = event.data;
          
          switch(type) {
            case 'SERVICE_WORKER_ERROR':
              console.error('Service Worker Error:', message);
              // ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ù†Ø§
              break;
              
            case 'SERVICE_WORKER_ACTIVATED':
              console.log('Service Worker activated:', message);
              break;
              
            case 'INSTALL_FAILED':
              console.error('Service Worker installation failed:', message);
              // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
              setTimeout(() => {
                registerServiceWorker();
              }, 5000);
              break;
          }
        });
        
        // Ø¨Ø¯Ø¡ ØªØ³Ø¬ÙŠÙ„ Service Worker
        registerServiceWorker();
        
      } else {
        console.log('Service Worker not supported');
      }

      // Ù…Ø¹Ø§Ù„Ø¬ Ø¥Ø¶Ø§ÙÙŠ Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù†Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„
      window.addEventListener('online', function() {
        console.log('Connection restored');
        // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚ Ø¥Ø¶Ø§ÙÙŠ Ù‡Ù†Ø§
      });

      window.addEventListener('offline', function() {
        console.log('Connection lost');
        // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚ Ø¥Ø¶Ø§ÙÙŠ Ù‡Ù†Ø§
      });
    </script>
  </body>
</html>
