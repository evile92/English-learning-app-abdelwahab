<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#1e293b" />
    <meta name="robots" content="index,follow" />
    <meta name="googlebot" content="index,follow" />
    <meta
      name="description"
      content="منصة StellarSpeak لتعلم اللغة الإنجليزية - دروس تفاعلية مجانية، اختبارات مستوى، وأدوات تعليمية متقدمة لإتقان الإنجليزية"
    />
    <meta name="keywords" content="تعلم الإنجليزية, دروس إنجليزية, قواعد اللغة, مفردات, نطق, اختبارات" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <link rel="sitemap" type="application/xml" href="%PUBLIC_URL%/sitemap.xml" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="//www.google-analytics.com">
    
    <style>
      /* Critical CSS للتحميل الفوري */
      body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
          'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
          sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        background-color: #0f172a;
        color: #e2e8f0;
        opacity: 0;
        animation: fadeInInitial 0.3s ease-in-out forwards;
      }
      @keyframes fadeInInitial { to { opacity: 1; } }
      #root { min-height: 100vh; display: flex; flex-direction: column; }
      .app-loading #root > * { visibility: hidden; }
      .app-loaded #root > * { visibility: visible; animation: contentFadeIn 0.2s ease-in-out; }
      @keyframes contentFadeIn { from { opacity: 0; } to { opacity: 1; } }
      .initial-loading { display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #0f172a; }
      .stellar-bg { position: fixed; inset: 0; background: linear-gradient(45deg, #0f172a 0%, #1e293b 100%); z-index: -1; }
      @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6736064173610503"
     crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MZPWQGFT9H"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-MZPWQGFT9H');
    </script>
    
    <link rel="preload" href="/static/css/main.9ce6682d.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/static/css/main.9ce6682d.css"></noscript>
    
    <title>StellarSpeak - منصة تعلم اللغة الإنجليزية التفاعلية | دروس مجانية</title>
  </head>
  <body class="app-loading">
    <noscript>
      <div style="text-align:center; padding:50px; font-family: Arial; background-color: #0f172a; color: #e2e8f0; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center;">
        <h1>🌟 StellarSpeak</h1>
        <h2>منصة تعلم اللغة الإنجليزية</h2>
        <p>عذراً، تحتاج إلى تفعيل JavaScript لاستخدام هذا التطبيق</p>
        <p>Please enable JavaScript to use this application</p>
      </div>
    </noscript>
    
    <div class="stellar-bg"></div>
    
    <div id="root">
      <div class="initial-loading">
        <div style="text-align: center;">
          <div style="width: 60px; height: 60px; border: 3px solid #374151; border-top: 3px solid #3b82f6; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
          <p style="margin-top: 20px; color: #94a3b8;">جاري التحميل...</p>
        </div>
      </div>
    </div>
    
    <div id="notification-portal"></div>

    <script>
      function markAppLoaded() {
        document.body.classList.remove('app-loading');
        document.body.classList.add('app-loaded');
        const loadingElement = document.querySelector('.initial-loading');
        if (loadingElement) {
          loadingElement.style.display = 'none';
        }
      }
      
      const mainStylesheet = document.querySelector('link[rel="stylesheet"]');
      if (mainStylesheet) {
          // في حال كان الـ CSS قد حُمّل بالفعل
        if (mainStylesheet.sheet) {
            markAppLoaded();
        } else {
            // انتظر حتى ينتهي تحميله
            mainStylesheet.addEventListener('load', markAppLoaded);
        }
      } else {
         // في حال لم يكن هناك ملف CSS (fallback)
         setTimeout(markAppLoaded, 100);
      }

      // Fallback timeout
      setTimeout(markAppLoaded, 2000);
    </script>

    <script>
        // ... لا تغيير هنا، كل كود الـ Service Worker يبقى كما هو ...
    </script>
  </body>
</html>
